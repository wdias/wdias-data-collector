(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[0],{203:function(e,t,a){e.exports=a(415)},208:function(e,t,a){},412:function(e,t,a){},413:function(e,t,a){},415:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),s=a(32),c=a.n(s),o=(a(208),a(12)),l=a(33),i=a(34),u=a(41),m=a(35),h=a(42),d=a(417),f=a(73),p=a(15),v=a.n(p),g=a(43),y=a.n(g),b=a(6),E=a(165),C=a(46),w=a.n(C),k=a(11),D=a.n(k),x=a(47),j=["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffffff","#000000"],O=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={chartData:[],helmCharts:[],timeoutRef:void 0,start:null,end:null},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("did mount:",this.props.namespace),this.loadData();var t=setInterval((function(){e.loadData()}),3e4);this.setState(Object(o.a)({},this.state,{timeoutRef:t}))}},{key:"componentDidUpdate",value:function(e){this.props.namespace!==e.namespace&&this.loadData()}},{key:"componentWillUnmount",value:function(){console.log("will unmount:",this.props.namespace),this.state.timeoutRef&&clearInterval(this.state.timeoutRef)}},{key:"loadCharts",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.a.awrap(y.a.get("".concat(this.props.dataServer,"/metrics/").concat("all"===e?"":"namespace/".concat(e,"/"),"helmCharts")));case 2:if(200!==(t=a.sent).status){a.next=7;break}if(t.data){a.next=6;break}return a.abrupt("return");case 6:this.setState({helmCharts:t.data});case 7:case"end":return a.stop()}}),null,this)}},{key:"loadData",value:function(){var e,t,a,n,r,s,c,o;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.namespace,l.next=3,v.a.awrap(this.loadCharts(e));case 3:return t=this.state,a=t.start,n=t.end,r=[["start",a],["end",n]].filter((function(e){return e&&e[1]})).map((function(e){return"".concat(e[0],"=").concat(e[1].format("YYYY-MM-DDTHH:mm[:00Z]"))})).join("&"),l.next=7,v.a.awrap(y.a.get("".concat(this.props.dataServer,"/metrics").concat("all"===e?"":"/namespace/"+e,"?").concat(r)));case 7:if(200!==(s=l.sent).status){l.next=15;break}if(c=s.data){l.next=12;break}return l.abrupt("return");case 12:o=c.map((function(e){var t={timestamp:e.timestamp,name:e.timestamp.split("T")[1].replace(":00Z","")},a=!0,n=!1,r=void 0;try{for(var s,c=e.podsPerHelmChart[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var o=s.value;t[o.helmChart]=o.noPods}}catch(l){n=!0,r=l}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}return t})),console.log("final:",o),this.setState({chartData:o});case 15:case"end":return l.stop()}}),null,this)}},{key:"onChangeDateTime",value:function(e,t){var a=this.state,n=a.start,r=a.end;"start"===e&&n&&(n=t,r=null!==r&&n>r?n.clone().add(30,"minute"):r),"end"===e&&r&&(r=t,n=null!==n&&n>r?r.clone().subtract(30,"minute"):n),console.log(n?n.utc().format("YYYY-MM-DDTHH:mm:ss"):"",r?r.utc().format("YYYY-MM-DDTHH:mm:ss"):""),this.setState(Object(o.a)({},this.state,{start:n,end:r}))}},{key:"onFocusDatetime",value:function(e){var t=this.state,a=t.start,n=t.end;if(console.log("on focus",e,a,n),"start"===e&&null===this.state.start&&this.setState(Object(o.a)({},this.state,{start:(null===n?new D.a:n.clone()).subtract(30,"minute")})),"end"===e&&null===this.state.end){var r=this.state.chartData.reduceRight((function(e,t){return D.a.max(e,new D.a(t.timestamp))}),new D.a("1970-01-01T00:00:00Z"));console.log("lastTimestamp: ",r.format("YYYY-MM-DDTHH:mm:ss")),this.setState(Object(o.a)({},this.state,{end:null===a?r:new D.a<a.clone().add(30,"minute")?new D.a:a.clone().add(30,"minute")}))}}},{key:"render",value:function(){var e=this,t=Object.values(x).reduce((function(e,t){return e.concat(t)}),[]),a=Object(o.a)({},x,{other:this.state.helmCharts.filter((function(e){return!t.includes(e)}))});return r.a.createElement("div",null,r.a.createElement("div",{className:"Menu"},r.a.createElement(E.a,{variant:"outline-primary",onClick:function(){return e.loadData()}},"Refresh"),r.a.createElement("div",null,"Starts :"),r.a.createElement(w.a,{value:this.state.start,onBlur:function(t){return e.onChangeDateTime("start",t)},onChange:function(t){return e.onChangeDateTime("start",t)},onFocus:function(){return e.onFocusDatetime("start")},strictParsing:!1}),r.a.createElement("div",null,"Ends :"),r.a.createElement(w.a,{value:this.state.end,onBlur:function(t){return e.onChangeDateTime("end",t)},onChange:function(t){return e.onChangeDateTime("end",t)},onFocus:function(){return e.onFocusDatetime("end")}})),"all"===this.props.view&&r.a.createElement("div",null,r.a.createElement("h5",null,"Pods Per HelmChart"),r.a.createElement(b.d,{width:1e3,height:200,data:this.state.chartData,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0,"text-align":"center"}},r.a.createElement(b.a,{strokeDasharray:"3 3"}),r.a.createElement(b.f,{dataKey:"name",padding:{left:30,right:30}}),r.a.createElement(b.g,null),r.a.createElement(b.e,null),r.a.createElement(b.b,null),this.state.helmCharts.map((function(e,t){return r.a.createElement(b.c,{type:"monotone",dataKey:e,stroke:j[t%j.length],fill:j[t%j.length],name:e,key:e})})))),"per-pod"===this.props.view&&Object.keys(a).map((function(t,n){if(a[t].find((function(t){return e.state.helmCharts.includes(t)})))return r.a.createElement("div",{key:"chartGroup-".concat(t)},r.a.createElement("hr",null),r.a.createElement("h3",null,t.toUpperCase()),a[t].filter((function(t){return e.state.helmCharts.includes(t)})).map((function(t,a){return r.a.createElement("div",{key:"helmChart-".concat(t)},r.a.createElement("h5",null,t),r.a.createElement(b.d,{width:1e3,height:200,data:e.state.chartData,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0,"text-align":"center"}},r.a.createElement(b.a,{strokeDasharray:"3 3"}),r.a.createElement(b.f,{dataKey:"name",padding:{left:30,right:30}}),r.a.createElement(b.g,null),r.a.createElement(b.e,null),r.a.createElement(b.b,null),r.a.createElement(b.c,{type:"monotone",dataKey:t,stroke:j[a%j.length],fill:j[a%j.length]})))})))})))}}]),t}(n.Component);O.defaultProps={namespace:"dafault",view:"all"};var Y=O,I=["#e6194b","#3cb44b","#ffe119","#4363d8","#f58231","#911eb4","#46f0f0","#f032e6","#bcf60c","#fabebe","#008080","#e6beff","#9a6324","#fffac8","#800000","#aaffc3","#808000","#ffd8b1","#000075","#808080","#ffffff","#000000"],S=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={chartData:[],helmCharts:[],timeoutRef:void 0,start:null,end:null},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){var e=this;console.log("did mount:",this.props.namespace),this.loadData();var t=setInterval((function(){e.loadData()}),3e4);this.setState(Object(o.a)({},this.state,{timeoutRef:t}))}},{key:"componentDidUpdate",value:function(e){this.props.namespace!==e.namespace&&this.loadData()}},{key:"componentWillUnmount",value:function(){console.log("will unmount:",this.props.namespace),this.state.timeoutRef&&clearInterval(this.state.timeoutRef)}},{key:"loadCharts",value:function(e){var t;return v.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,v.a.awrap(y.a.get("".concat(this.props.dataServer,"/metrics/").concat("all"===e?"":"namespace/".concat(e,"/"),"helmCharts")));case 2:if(200!==(t=a.sent).status){a.next=7;break}if(t.data){a.next=6;break}return a.abrupt("return");case 6:this.setState({helmCharts:t.data});case 7:case"end":return a.stop()}}),null,this)}},{key:"loadData",value:function(){var e,t,a,n,r,s,c,o;return v.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return e=this.props.namespace,l.next=3,v.a.awrap(this.loadCharts(e));case 3:return t=this.state,a=t.start,n=t.end,r=[["start",a],["end",n]].filter((function(e){return e&&e[1]})).map((function(e){return"".concat(e[0],"=").concat(e[1].format("YYYY-MM-DDTHH:mm[:00Z]"))})).join("&"),l.next=7,v.a.awrap(y.a.get("".concat(this.props.dataServer,"/metrics/").concat("all"===e?"":"namespace/".concat(e,"/"),"resources?").concat(r)));case 7:if(200!==(s=l.sent).status){l.next=16;break}if(c=s.data){l.next=12;break}return l.abrupt("return");case 12:console.log(c),o=c.map((function(e){if(e.resourcesPerPodPerHelmChart){var t={timestamp:e.timestamp,name:e.timestamp.split("T")[1].replace(":00Z","")},a=!0,n=!1,r=void 0;try{for(var s,c=e.resourcesPerPodPerHelmChart[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var o=s.value;t["cpu-".concat(o.helmChart)]=Math.ceil(o.resourcesPerPod.reduce((function(e,t){return e+t.cpu.length>1?parseInt(t.cpu.slice(0,-1)):0}),0)/1e6),t["memory-".concat(o.helmChart)]=o.resourcesPerPod.reduce((function(e,t){return e+parseInt(t.memory.slice(0,-2))/1024}),0)}}catch(l){n=!0,r=l}finally{try{a||null==c.return||c.return()}finally{if(n)throw r}}return t}})),console.log("final:",o),this.setState({chartData:o});case 16:case"end":return l.stop()}}),null,this)}},{key:"onChangeDateTime",value:function(e,t){var a=this.state,n=a.start,r=a.end;"start"===e&&n&&(n=t,r=null!==r&&n>r?n.clone().add(30,"minute"):r),"end"===e&&r&&(r=t,n=null!==n&&n>r?r.clone().subtract(30,"minute"):n),console.log(n?n.utc().format("YYYY-MM-DDTHH:mm:ss"):"",r?r.utc().format("YYYY-MM-DDTHH:mm:ss"):""),this.setState(Object(o.a)({},this.state,{start:n,end:r}))}},{key:"onFocusDatetime",value:function(e){var t=this.state,a=t.start,n=t.end;if(console.log("on focus",e,a,n),"start"===e&&null===this.state.start&&this.setState(Object(o.a)({},this.state,{start:(null===n?new D.a:n.clone()).subtract(30,"minute")})),"end"===e&&null===this.state.end){var r=this.state.chartData.reduceRight((function(e,t){return D.a.max(e,new D.a(t.timestamp))}),new D.a("1970-01-01T00:00:00Z"));console.log("lastTimestamp: ",r.format("YYYY-MM-DDTHH:mm:ss")),this.setState(Object(o.a)({},this.state,{end:null===a?r:new D.a<a.clone().add(30,"minute")?new D.a:a.clone().add(30,"minute")}))}}},{key:"render",value:function(){var e=this,t=Object.values(x).reduce((function(e,t){return e.concat(t)}),[]),a=Object(o.a)({},x,{other:this.state.helmCharts.filter((function(e){return!t.includes(e)}))});return r.a.createElement("div",null,r.a.createElement("div",{className:"Menu"},r.a.createElement(E.a,{variant:"outline-primary",onClick:function(){return e.loadData()}},"Refresh"),r.a.createElement("div",null,"Starts :"),r.a.createElement(w.a,{value:this.state.start,onBlur:function(t){return e.onChangeDateTime("start",t)},onChange:function(t){return e.onChangeDateTime("start",t)},onFocus:function(){return e.onFocusDatetime("start")},strictParsing:!1}),r.a.createElement("div",null,"Ends :"),r.a.createElement(w.a,{value:this.state.end,onBlur:function(t){return e.onChangeDateTime("end",t)},onChange:function(t){return e.onChangeDateTime("end",t)},onFocus:function(){return e.onFocusDatetime("end")}})),"all"===this.props.view&&r.a.createElement("div",null,r.a.createElement("h5",null,"CPU usage Per HelmChart"),r.a.createElement(b.d,{width:1e3,height:200,data:this.state.chartData,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0,"text-align":"center"}},r.a.createElement(b.a,{strokeDasharray:"3 3"}),r.a.createElement(b.f,{dataKey:"name",padding:{left:30,right:30}}),r.a.createElement(b.g,null),r.a.createElement(b.e,null),r.a.createElement(b.b,null),this.state.helmCharts.map((function(e,t){return r.a.createElement(b.c,{type:"monotone",dataKey:"cpu-".concat(e),stroke:I[t%I.length],fill:I[t%I.length],name:e,key:e})}))),r.a.createElement("h5",null,"Memory usage Per HelmChart"),r.a.createElement(b.d,{width:1e3,height:200,data:this.state.chartData,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0,"text-align":"center"}},r.a.createElement(b.a,{strokeDasharray:"3 3"}),r.a.createElement(b.f,{dataKey:"name",padding:{left:30,right:30}}),r.a.createElement(b.g,null),r.a.createElement(b.e,null),r.a.createElement(b.b,null),this.state.helmCharts.map((function(e,t){return r.a.createElement(b.c,{type:"monotone",dataKey:"memory-".concat(e),stroke:I[t%I.length],fill:I[t%I.length],name:e,key:e})})))),"per-pod"===this.props.view&&Object.keys(a).map((function(t,n){if(a[t].find((function(t){return e.state.helmCharts.includes(t)})))return r.a.createElement("div",{key:"chartGroup-".concat(t)},r.a.createElement("hr",null),r.a.createElement("h3",null,t.toUpperCase()),a[t].filter((function(t){return e.state.helmCharts.includes(t)})).map((function(t,a){return r.a.createElement("div",{key:"helmChart-".concat(t)},r.a.createElement("h5",null,t),r.a.createElement(b.d,{width:1e3,height:200,data:e.state.chartData,syncId:"anyId",margin:{top:10,right:30,left:0,bottom:0,"text-align":"center"}},r.a.createElement(b.a,{strokeDasharray:"3 3"}),r.a.createElement(b.f,{dataKey:"name",padding:{left:30,right:30}}),r.a.createElement(b.g,{yAxisId:"left",label:"CPU"}),r.a.createElement(b.g,{yAxisId:"right",orientation:"right",label:"Memory"}),r.a.createElement(b.e,null),r.a.createElement(b.b,null),r.a.createElement(b.c,{yAxisId:"left",type:"monotone",dataKey:"cpu-".concat(t),stroke:I[a%I.length],fill:I[a%I.length]}),r.a.createElement(b.c,{yAxisId:"right",type:"monotone",dataKey:"memory-".concat(t),stroke:I[a+1%I.length],fill:I[a%I.length]})))})))})))}}]),t}(n.Component);S.defaultProps={namespace:"dafault",view:"all"};var M=S,T=(a(412),a(413),function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(u.a)(this,Object(m.a)(t).call(this,e))).state={route:"/resources",namespace:"default",view:"all"},a}return Object(h.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){}},{key:"onNamespaceChange",value:function(e){this.setState(Object(o.a)({},this.state,{namespace:e}))}},{key:"onRouteChange",value:function(e){this.setState(Object(o.a)({},this.state,{route:e}))}},{key:"onViewChange",value:function(e){this.setState(Object(o.a)({},this.state,{view:e}))}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"App"},r.a.createElement("div",{className:"Menu"},r.a.createElement(d.a,{id:"dropdown-view",title:this.state.route,size:"lg"},r.a.createElement(f.a.Item,{onClick:function(){return e.onRouteChange("/pods")}},"/pods"),r.a.createElement(f.a.Item,{onClick:function(){return e.onRouteChange("/resources")}},"/resources")),r.a.createElement(d.a,{id:"dropdown-namespace",title:this.state.namespace,size:"lg"},r.a.createElement(f.a.Item,{onClick:function(){return e.onNamespaceChange("default")}},"Default"),r.a.createElement(f.a.Item,{onClick:function(){return e.onNamespaceChange("kube-system")}},"Kube-System"),r.a.createElement(f.a.Item,{onClick:function(){return e.onNamespaceChange("all")}},"All")),r.a.createElement(d.a,{id:"dropdown-view",title:this.state.view,size:"lg"},r.a.createElement(f.a.Item,{onClick:function(){return e.onViewChange("all")}},"all"),r.a.createElement(f.a.Item,{onClick:function(){return e.onViewChange("per-pod")}},"per-pod"))),r.a.createElement("header",{className:"App-header"},"/pods"===this.state.route&&r.a.createElement(Y,{namespace:this.state.namespace,view:this.state.view,dataServer:"http://analysis-api.wdias.com"}),"/resources"===this.state.route&&r.a.createElement(M,{namespace:this.state.namespace,view:this.state.view,dataServer:"http://analysis-api.wdias.com"})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(T,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},47:function(e){e.exports=JSON.parse('{"core":["adapter-metadata","adapter-status","adapter-query","adapter-scalar","adapter-vector","adapter-grid"],"databases":["adapter-extension-mysql","adapter-metadata-mysql","adapter-redis","adapter-query-mongodb","adapter-scalar-influxdb","adapter-vector-influxdb"],"import":["import-ascii-grid-binary","import-ascii-grid-upload","import-json-raw"],"export":["export-json-raw","export-netcdf-binary"],"extension":["adapter-extension","extension-handler","extension-scheduler","extension-interpolation","extension-transformation","extension-validation","interpolation-serial-linear","transformation-aggregate-accumulative","validation-min-non-missing-values-check"],"test":["metrics-server","wdias-performance-test","wdias-data-collector","wdias-data-collector-api"]}')}},[[203,1,2]]]);
//# sourceMappingURL=main.173c13ec.chunk.js.map